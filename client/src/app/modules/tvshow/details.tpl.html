<div ng-switch on="loading" class="tvshow detail fill-height" ng-class="{loading : loading}">
    <div ng-switch-when="true" class="loading"><div class="kodi"></div></div>
    <div ng-switch-when="false">
        <i class="icon-chevron-left previous"
           ng-if="seasons.indexOf(season) > 0"
           ng-click="previousSeason()"></i>
        <i class="icon-chevron-right next"
           ng-if="seasons.indexOf(season) < seasons.length-1"
           ng-click="nextSeason()"></i>
        <div class="experimental row" ng-show="!isExternalAddonAvailable && isUsingExternalAddon()">
            <div class="offset2 span8">
                <i class="icon icon-beaker"></i>
                {{host.videoAddon}} needed to preview discoverable content.
            </div>
        </div>
        <div class="row wrapper">
            
            <div class="fanart" image image-source="getImage(show.fanart)"></div>
            <div class="title">
                <h2>{{show.title || show.name}}</h2>
                <h1>{{seasonName(season)}}</h1>
            </div>
            <trakt-stats stats="stats"></trakt-stats>
        </div>
        <div class="description row">
            <div class="offset1 span2 sidebar">
                <div class="poster-wrapper">
                    <img class=" poster" image image-source="getImage(season.thumbnail || season.poster, 'w500')"/>
                </div>
                
                <ul class="nav sections">
                    <li style="text-align: center">
                        {{show.title || show.name}} 
                        <seekbar seekbar-value="show.watchedepisodes" seekbar-max="show.episode"
                                 seekbar-read-only="true" class="progress-wrapper"
                                 ng-if="show.watchedepisodes">
                        </seekbar>
                    </li>
                    <li class="row">
                        <div class="span6 label">
                            Season
                        </div>
                        <div class="span6 value">{{season.season}}</div>
                    </li>
                    <li class="row">
                        <div class="span6 label">
                             <i class="icon-star"></i>
                             Rating
                        </div>
                        <div class="span6 value">{{show.rating| number : 1}}</div>
                    </li>
                    <li class="row">
                        <div class="span6 label">
                            <i class="genre-{{show.genre[0].toLowerCase()}}"></i>
                            Genre
                        </div>
                        <div class="span6 value"> {{show.genre[0]}} </div>
                    </li>
                    <li class="row">
                        <div class="span6 label">
                             <i class="icon-calendar"></i>
                             Released
                        </div>
                        <div class="span6 value">{{show.year+season.season-1}}</div>
                    </li>
                    <li class="row">
                        <div class="span6 label">
                             <i class="icon-trakt"></i>
                             Watching
                        </div>
                        <div class="span6 value">{{watching.length}}</div>
                    </li>
                    <li class="row" ng-show="show.watchedepisodes">
                        <div class="span6 label">Progress</div>
                        <div class="span6 value">{{show.watchedepisodes}}/{{show.episode}}</div>
                    </li>
                </ul>
            </div>
            <div class="span7 content">
                <h1>Synopsis</h1>
                <p>{{show.plot}}</p>
                <div ng-if="nextAiringEpisode">
                    <h1>
                      <i class="icon-time"></i>
                      Next Episode
                    </h1>
                    <div class="row next-episode">
                        <div class="thumbnail span4" image image-source="nextAiringEpisode.thumbnail | tmdbImage:'w300' | fallback:'img/icons/awe-512.png'">
                        </div>
                        <div class="span8">
                            <p>
                                {{nextAiringEpisode.episode | episode:nextAiringEpisode.season}} -
                                {{nextAiringEpisode.title || nextAiringEpisode.name}} airs {{nextAiringEpisode.firstaired | date : 'fullDate'}}
                            </p>
                            <p>{{nextAiringEpisode.plot}}</p>
                        </div>
                    </div>
                </div>
                <div ng-show="seasons.length">
                    <h1>
                        <span class="season">
                            <span class="md-circle fanart" image image-source="getImage(season.thumbnail || season.poster, 'w500')">
                            </span>
                            {{seasonName(season)}}
                        </span>
                        <i class="icon-chevron-right"></i>
                        Episodes
                    </h1>
                </div>
                <ul data-type="list">
                    <li class="row episode playable" ng-repeat="episode in episodes"
                        ng-click="play(episode)">
                        <div class="thumbnail span4" image image-source="getImage(episode.thumbnail, 'w300')">
                            <div class="md-action md-action-primary">
                                <i class="icon-play"></i>
                            </div>
                            <div class="playcount" ng-show="episode.playcount">
                                 <i class="icon-ok"></i>
                            </div>
                        </div>
                        <div class="span8">
                            <h3>
                                <span class="se">{{episode.episode | episode:episode.season}}</span>
                                {{episode.title || episode.name}}
                            </h3>
                            <div>
                                <span class="firstaired" ng-if="episode.firstaired">{{episode.firstaired}}</span>
                                <span class="runtime" ng-if="episode.runtime">{{episode.runtime | time | date:'HH:mm'}}</span>
                            </div>
                            <p>{{episode.plot}}</p>
                            <div class="controls" ng-show="hasControls()">
                                <i class="icon-plus" ng-click="xbmc.queue({'episodeid' : episode.episodeid}); $event.stopPropagation();"
                                   ng-show="player.active"></i>
                                <i ng-class="{'icon-eye-open':!episode.playcount, 'icon-eye-close':episode.playcount}"
                                   ng-click="toggleWatched(episode); $event.stopPropagation();"
                                ></i>
                                <i class="icon-trash"
                                   ng-click="remove($index, episode); $event.stopPropagation();"
                                ></i>
                            </div>
                        </div>
                    </li>
                </ul>
                <div ng-show="!episodes.length" class="empty list">Oops! nothing here</div>
                <div ng-if="comments.length">
                    <h1>Popular comments</h1>
                    <trakt-comments comments="comments"></trakt-comments>
                </div>
            </div>
        </div>
    </div>
</div>
